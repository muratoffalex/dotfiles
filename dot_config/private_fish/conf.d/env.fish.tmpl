# Add my custom functions to be autoloaded
if test -d $__fish_config_dir/custom_functions.d
  set -gp fish_function_path $__fish_config_dir/custom_functions.d
end

{{ if .proxy.enable }}
    if test -n "{{ .proxy.https }}"
        set -gx https_proxy {{ .proxy.https }}
    end
    if test -n "{{ .proxy.http }}"
        set -gx http_proxy {{ .proxy.http }}
    end
    if test -n "{{ .proxy.no_proxy }}"
        set -gx no_proxy {{ .proxy.no_proxy }}
    end
    if test -n "{{ .proxy.ftp }}"
        set -gx ftp_proxy {{ .proxy.ftp }}
    end
{{ end }}

set -g fish_greeting # Disable fish greeting 
set -gx EDITOR {{ .editor }}
set -gx FISH_CONFIG_PATH $__fish_config_dir/config.fish
set -gx JJ_CONFIG $HOME/.config/jj/config.toml
set -gx LANG en_US.UTF-8
set -gx LC_ALL en_US.UTF-8
set -gx LC_CTYPE UTF-8
set -gx HOMEBREW_AUTO_UPDATE_SECS 86400 # 1 day
set -gx HOMEBREW_NO_ENV_HINTS 1
set -gx DEV_PATH {{ .dev_path }}

if status is-interactive
    set -gx PGP_TTY (tty)
end

set -gx theme (get_theme)

# TMUX env doesn't work properly in fish
# it doesn't reset when tmux session is closed
# it is affect to sesh util
# it is temporary solution
if set -q TMUX
    # Check if tmux is running and if there are active sessions
    if not pgrep tmux >/dev/null
        # If tmux is not running, clear the variable
        set -e TMUX
        set -Ue TMUX
    else if test -z "$TMUX"
        # If the variable is empty, clear it too
        set -e TMUX
        set -Ue TMUX
    end
end

if type -q nvim
  set -gx EDITOR nvim
  set -gx VISUAL nvim
else if type -q vim
  set -gx EDITOR vim
  set -gx VISUAL vim
else
  set -gx EDITOR vi
  set -gx VISUAL vi
end

if type -q bat
  set -gx BAT_THEME Monokai Extended Bright # Set theme for BAT
end

if type -q fzf
  set -gx FZF_DEFAULT_COMMAND 'fd --type f --hidden --follow --exclude .git'
end
